# @layout post
# @title firefox の同期不具合
# @date 2013-5-3 
# @tags firefox

下記のエラーが頻繁に表示される。
#+BEGIN_EXAMPLE
「接続中にエラーが発生しました: 不明なエラー。この処理は自動的に再施行されます。」
#+END_EXAMPLE

これの対処方法は、
- 「メニュー」→「ツール」→「オプション」→「Syncタブ」
- 「アカウントを管理ボタン」→「Syncをリセット」
で、もとに戻るはず。

* 追記
結局もとに戻らなかった。さらにいろいろ調査してみたところ、アドレスバーに下記を入力すると、
syncエラーの原因が読めることがわかった。
#+BEGIN_SRC sh
about:sync-log
#+END_SRC
今まで同期エラーがでると、原因を示してくれないので対処のしようがなかったのだけれど、
このログをみれば詳細な情報が手にはいるので大助かり。

自分の場合、ログをみたところ、bookmark同期に原因があった模様。
#+BEGIN_SRC sh
1368414694893	Sync.Engine.Bookmarks	DEBUG	First sync, uploading all items
1368414694893	Sync.Engine.Bookmarks	INFO	2 outgoing items pre-reconciliation
1368414695441	Sync.Engine.Bookmarks	WARN	Got exception "Component returned failure code: 0x80070057 (NS_ERROR_ILLEGAL_VALUE) [nsINavBookmarksService.getItemType] Stack trace: _buildGUIDMap()@resource://gre/modules/services-sync/engines/bookmarks.js:233 < resource://gre/modules/services-sync/engines/bookmarks.js:357 < _mapDupe()@resource://gre/modules/services-sync/engines/bookmarks.js:313 < _findDupe()@resource://gre/modules/services-sync/engines/bookmarks.js:413 < _reconcile()@resource://services-sync/engines.js:1120 < resource://services-sync/engines.js:903 < resource://gre/modules/services-sync/record.js:625 < Channel_onDataAvail()@resource://gre/modules/services-sync/resource.js:542 < <file:unknown>" building GUID map. Skipping all other incoming items.
1368414695441	Sync.Engine.Bookmarks	WARN	Reconciliation failed: aborting incoming processing.
#+END_SRC
そこで「ツール」→「オプション」→「Sync」→「同期するデータ」から、
ブックマークを外して再度同期したところ、エラーが表示されなくなった。

しかしこのままではブックマークの同期ができないのでなんとかしなくてはならない。
そこで、下記の手順をとることにした。
- https://account.services.mozilla.com にアクセス
- 左ペインの =Clear Your Sync data= をクリック 
- =Clear My Sync Data= をクリックしてサーバー上のデータを削除
- 上述した方法でアカウントをリセット。そのとき、「他のすべてのデバイスのブラウザデータを、このパソコンのデータと置き換える」を選択する。
ただしこの方法は、同期もとにするPCのデータに異常がない場合に有効。

以上で同期が復活するはず。

* 参考
- https://account.services.mozilla.com/sync/request_quota
- http://coffeecupman.blog28.fc2.com/blog-entry-25.html
